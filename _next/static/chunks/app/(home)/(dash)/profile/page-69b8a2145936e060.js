(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3],{20454:(e,t,s)=>{Promise.resolve().then(s.bind(s,29839))},24933:(e,t,s)=>{"use strict";s.d(t,{n:()=>i});var a=s(95155),l=s(10168);let i=e=>{let{title:t,subtitle:s}=e;return(0,a.jsxs)(l.Z,{fullWidth:!0,radius:"lg",className:"flex flex-col text-left p-4 gap-4 border border-default-200 min-h-[120px] justify-between",shadow:"none",children:[(0,a.jsx)("h1",{className:"text-2xl text-default-700 font-black",children:t}),(0,a.jsx)("h2",{className:"text-xl font-bold text-default-400",children:s})]})}},29839:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>G});var a=s(95155),l=s(75191),i=s(24933),r=s(59568),n=s(18850),d=s(65701),c=s(43350),j=s(77520),u=s(84520),x=s(1493),o=s(97376),N=s(96693);let M=()=>{let{signOut:e}=(0,r.A)(),{isOpen:t,onOpen:s,onOpenChange:l}=(0,n.j)();return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(d.T,{color:"danger",variant:"flat",onPress:s,startContent:(0,a.jsx)(N.A,{weight:"BoldDuotone",size:20,className:"min-w-[20px]"}),size:"sm",children:"退出"}),(0,a.jsx)(c.Y,{isOpen:t,onOpenChange:l,radius:"lg",hideCloseButton:!0,children:(0,a.jsx)(j.g,{children:t=>(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(u.c,{children:"提示"}),(0,a.jsx)(x.h,{children:"您确认要退出登录？"}),(0,a.jsxs)(o.q,{children:[(0,a.jsx)(d.T,{color:"danger",variant:"light",onPress:t,children:"取消"}),(0,a.jsx)(d.T,{color:"danger",onPress:e,children:"确认"})]})]})})})]})};var g=s(86613),m=s(40933),I=s(53929),h=s(49081),y=s(32774),f=s(15471),T=s(85812),L=s(30128),z=s(12115),p=s(60838),b=s(74692),D=s(56671),w=s(85005),S=s(75243),A=s(23156),k=s(85805);let E=s(39022)({html:!0,linkify:!0,breaks:!0,typographer:!0,listIndent:!0}),v=e=>{let{slides:t,options:s,className:l}=e,[i,r]=(0,w.A)(s,[(0,k.A)()]),{isOpen:N,onOpen:M,onOpenChange:m}=(0,n.j)(),[I,h]=(0,z.useState)(0);return(0,z.useEffect)(()=>{if(r){for(let e=0;e<=t.length;e++)if(t[e]){let s=t[e].tags;if(s&&s.includes("弹窗")){h(e),M();return}}}},[r,t]),(0,a.jsxs)("section",{className:(0,g.cn)("embla",l),children:[(0,a.jsx)("div",{className:"embla__viewport",ref:i,children:(0,a.jsx)("div",{className:"embla__container",children:t.map((e,t)=>{var s;return(0,a.jsxs)("div",{onClick:()=>{h(t),M()},className:(0,g.cn)("embla__slide","w-full h-60 shadow-none cursor-pointer"),children:[(0,a.jsx)(L.W,{alt:"",radius:"sm",removeWrapper:!0,className:"bg-default-100 z-0 object-cover object-center w-full h-full",src:null!=(s=e.img_url)?s:"data:image/svg+xml;base64,PHN2ZyBoZWlnaHQ9IjIwMCIgd2lkdGg9IjIwMCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48ZyBmaWxsPSJub25lIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiIHRyYW5zZm9ybT0idHJhbnNsYXRlKDEwIDgpIj48Y2lyY2xlIGN4PSIxNzYiIGN5PSIxMiIgcj0iNCIgc3Ryb2tlPSIjZGRkIiBzdHJva2Utd2lkdGg9IjEuMjUiLz48cGF0aCBkPSJNMjAuNS41bDIzIDExbS0yOSA4NGwtMy43OSAxMC4zNzdNMjcuMDM3IDEzMS40bDUuODk4IDIuMjAzLTMuNDYgNS45NDcgNi4wNzIgMi4zOTItMy45MzMgNS43NThtMTI4LjczMyAzNS4zN2wuNjkzLTkuMzE2IDEwLjI5Mi4wNTIuNDE2LTkuMjIyIDkuMjc0LjMzMk0uNSA0OC41czYuMTMxIDYuNDEzIDYuODQ3IDE0LjgwNWMuNzE1IDguMzkzLTIuNTIgMTQuODA2LTIuNTIgMTQuODA2TTEyNC41NTUgOTBzLTcuNDQ0IDAtMTMuNjcgNi4xOTJjLTYuMjI3IDYuMTkyLTQuODM4IDEyLjAxMi00LjgzOCAxMi4wMTJtMi4yNCA2OC42MjZzLTQuMDI2LTkuMDI1LTE4LjE0NS05LjAyNS0xOC4xNDUgNS43LTE4LjE0NSA1LjciIHN0cm9rZT0iI2RkZCIgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIiBzdHJva2Utd2lkdGg9IjEuMjUiLz48cGF0aCBkPSJNODUuNzE2IDM2LjE0Nmw1LjI0My05LjUyMWgxMS4wOTNsNS40MTYgOS41MjEtNS40MSA5LjE4NUg5MC45NTN6bTYzLjkwOSAxNS40NzloMTAuNzV2MTAuNzVoLTEwLjc1eiIgc3Ryb2tlPSIjZGRkIiBzdHJva2Utd2lkdGg9IjEuMjUiLz48ZyBmaWxsPSIjZGRkIj48Y2lyY2xlIGN4PSI3MS41IiBjeT0iNy41IiByPSIxLjUiLz48Y2lyY2xlIGN4PSIxNzAuNSIgY3k9Ijk1LjUiIHI9IjEuNSIvPjxjaXJjbGUgY3g9IjgxLjUiIGN5PSIxMzQuNSIgcj0iMS41Ii8+PGNpcmNsZSBjeD0iMTMuNSIgY3k9IjIzLjUiIHI9IjEuNSIvPjxwYXRoIGQ9Ik05MyA3MWgzdjNoLTN6bTMzIDg0aDN2M2gtM3ptLTg1IDE4aDN2M2gtM3oiLz48L2c+PHBhdGggZD0iTTM5LjM4NCA1MS4xMjJsNS43NTgtNC40NTQgNi40NTMgNC4yMDUtMi4yOTQgNy4zNjNoLTcuNzl6TTEzMC4xOTUgNC4wM2wxMy44MyA1LjA2Mi0xMC4wOSA3LjA0OHptLTgzIDk1bDE0LjgzIDUuNDI5LTEwLjgyIDcuNTU3LTQuMDEtMTIuOTg3ek01LjIxMyAxNjEuNDk1bDExLjMyOCAyMC44OTdMMi4yNjUgMTgweiIgc3Ryb2tlPSIjZGRkIiBzdHJva2Utd2lkdGg9IjEuMjUiLz48cGF0aCBkPSJNMTQ5LjA1IDEyNy40NjhzLS41MSAyLjE4My45OTUgMy4zNjZjMS41NiAxLjIyNiA4LjY0Mi0xLjg5NSAzLjk2Ny03Ljc4NS0yLjM2Ny0yLjQ3Ny02LjUtMy4yMjYtOS4zMyAwLTUuMjA4IDUuOTM2IDAgMTcuNTEgMTEuNjEgMTMuNzMgMTIuNDU4LTYuMjU3IDUuNjMzLTIxLjY1Ni01LjA3My0yMi42NTQtNi42MDItLjYwNi0xNC4wNDMgMS43NTYtMTYuMTU3IDEwLjI2OC0xLjcxOCA2LjkyIDEuNTg0IDE3LjM4NyAxMi40NSAyMC40NzYgMTAuODY2IDMuMDkgMTkuMzMxLTQuMzEgMTkuMzMxLTQuMzEiIHN0cm9rZT0iI2RkZCIgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIiBzdHJva2Utd2lkdGg9IjEuMjUiLz48L2c+PC9zdmc+"}),(0,a.jsx)(S.R,{size:"sm",radius:"sm",color:"danger",className:"absolute top-4 left-8 z-10",children:"公告"}),(0,a.jsxs)("div",{className:"absolute bottom-0 left-0 right-0 bg-content1/75 m-4 ml-8 px-4 p-2 z-10 flex flex-col gap-1 rounded-small",children:[(0,a.jsx)("span",{className:"font-bold text-foreground",children:e.title}),(0,a.jsx)("span",{className:"text-xs text-default-700",children:new Date(1e3*e.updated_at).toLocaleDateString("zh-CN",{year:"numeric",month:"2-digit",day:"2-digit"})})]})]},t)})})}),(0,a.jsx)(c.Y,{isOpen:N,onOpenChange:m,radius:"lg",hideCloseButton:!0,size:"2xl",scrollBehavior:"inside",children:(0,a.jsx)(j.g,{children:e=>(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(u.c,{children:t[I].title}),(0,a.jsx)(x.h,{children:(0,a.jsx)(A.H,{children:(0,a.jsx)("div",{className:"html-content",dangerouslySetInnerHTML:{__html:E.render(t[I].content)}})})}),(0,a.jsxs)(o.q,{className:"text-sm text-foreground flex justify-between items-center",children:["发布时间：",new Date(1e3*t[I].updated_at).toLocaleDateString("zh-CN",{year:"numeric",month:"short",day:"numeric",hour:"numeric",minute:"numeric"}),(0,a.jsx)(d.T,{size:"sm",color:"primary",onPress:e,className:(0,g.cn)("transition-transform duration-300 hover:scale-105 tracking-wider"),children:"我知道了"})]})]})})})]})};s(69547);var C=s(24654),_=s(86409),O=s(88431),Y=s(68676),U=s(31857),P=s(792);function G(){let{config:e}=(0,r.A)(),{data:t}=(0,p.Ay)("user/getSubscribe"),{data:s}=(0,p.Ay)("user/notice/fetch"),[,N]=(0,b.Cj)();(0,z.useEffect)(()=>{var e,s;if(!t||!t.data)return;let a=t.data,l={plan:null!=(s=null==(e=a.plan)?void 0:e.name)?s:null,transfer_enable:a.transfer_enable,u:a.u,d:a.d,expired_at:a.expired_at,reset_day:a.reset_day};Object.keys(l).forEach(e=>{null===l[e]&&delete l[e]}),P.YH.user.setEmail(a.email),P.YH.session.setData(l)},[t]);let w=(0,z.useMemo)(()=>{if(!t||!t.data)return{u:0,d:0,transfer_enable:0};let{u:e,d:s,transfer_enable:a}=t.data;return{u:e,d:s,transfer_enable:a}},[t]),S=(0,z.useMemo)(()=>{var e;let s={expired_at:0,reset_day:0,days_remaining:0};if(!t||!t.data||(s.reset_day=null!=(e=t.data.reset_day)?e:-1,!t.data.expired_at))return s;s.expired_at=t.data.expired_at;let a=Math.floor(Date.now()/1e3),l=s.expired_at-a;return s.days_remaining=Math.ceil(l/86400),s},[t]),A=(0,z.useMemo)(()=>t&&t.data?t.data.plan:null,[t]),k=(0,z.useMemo)(()=>{var e;return t&&t.data&&null!=(e=t.data.subscribe_url)?e:""},[t]),{isOpen:E,onOpen:G,onOpenChange:B}=(0,n.j)();return t&&t.data?(0,a.jsxs)("div",{className:"flex flex-col w-full gap-6 sm:gap-12 items-center justify-center",children:[(0,a.jsxs)("div",{className:(0,g.cn)("flex flex-row gap-2 items-center justify-between w-full"),children:[(0,a.jsxs)("span",{className:"text-start text-2xl sm:text-4xl font-extrabold w-[95%] truncate",children:["您好，",t.data.email]}),(0,a.jsx)(M,{})]}),s&&s.data&&s.data.length>0&&(0,a.jsx)(v,{slides:s.data,options:{loop:!0}}),(0,a.jsxs)("div",{className:(0,g.cn)("grid grid-cols-1 sm:grid-cols-3 gap-4 items-start justify-between w-full"),children:[(0,a.jsx)(i.n,{title:"套餐详情",subtitle:(0,a.jsxs)("div",{className:"w-full flex items-center justify-between",children:[(0,a.jsx)("span",{children:A?A.name:"暂无套餐"}),(0,a.jsx)(d.T,{size:"sm",radius:"lg",color:"primary",as:m.h,href:"/shop".concat(A?"?id=".concat(A.id):""),children:A?"续费套餐":"购买套餐"})]})}),(0,a.jsx)(i.n,{title:"到期时间",subtitle:A?S.expired_at?S.days_remaining>0?"剩余 ".concat(S.days_remaining," 天"):0===S.days_remaining?"今天到期":(0,a.jsxs)("span",{className:"text-danger",children:["已过期 ",Math.abs(S.days_remaining)," 天"]}):"永久有效":"暂无套餐"}),(0,a.jsx)(i.n,{title:"剩余流量",subtitle:A?(0,a.jsxs)("div",{className:"w-full flex items-center justify-between",children:[(0,a.jsxs)("span",{children:[(0,l.O)(w.transfer_enable-w.u-w.d,{standard:"jedec"}),S.expired_at&&S.days_remaining<0&&" (已失效)"]}),(w.u+w.d)/w.transfer_enable>.9&&(0,a.jsx)(d.T,{size:"sm",radius:"lg",color:"danger",as:"a",href:"/shop?id=".concat(A.id,"&reset=true"),children:"重置流量"})]}):"暂无套餐"})]}),(0,a.jsxs)("div",{className:"flex flex-col sm:flex-row gap-4 items-center justify-between w-full",children:[(0,a.jsx)(d.T,{fullWidth:!0,color:"primary",variant:"flat",onPress:()=>{N(k),D.oR.success("订阅链接已复制到剪贴板")},startContent:(0,a.jsx)(C.A,{size:20,weight:"LineDuotone"}),children:"复制订阅链接"}),(0,a.jsxs)(I.y,{placement:"bottom",showArrow:!0,children:[(0,a.jsx)(h.T,{children:(0,a.jsx)(d.T,{fullWidth:!0,color:"primary",variant:"flat",onPress:G,startContent:(0,a.jsx)(_.A,{size:20,weight:"LineDuotone"}),children:"生成二维码订阅"})}),(0,a.jsx)(y.C,{children:(0,a.jsxs)("div",{className:"p-2 flex flex-col items-center",children:[(0,a.jsx)(U.h,{value:k,size:192,level:"L",className:"border border-gray-200"}),(0,a.jsx)("br",{}),(0,a.jsx)("p",{className:"font-semibold tracking-wider",children:"使用支持扫码的客户端进行订阅"})]})})]}),(0,a.jsx)(d.T,{fullWidth:!0,color:"primary",variant:"flat",onPress:G,startContent:(0,a.jsx)(O.A,{size:20,weight:"LineDuotone"}),children:"导入至客户端"})]}),(0,a.jsx)(c.Y,{isOpen:E,onOpenChange:B,radius:"lg",hideCloseButton:!0,children:(0,a.jsx)(j.g,{children:()=>(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(u.c,{children:"导入至客户端"}),(0,a.jsx)(x.h,{children:(0,a.jsx)(f.r,{"aria-label":"Options",classNames:{panel:(0,g.cn)("p-0 gap-2 flex flex-row w-full","justify-center md:justify-start items-center flex-wrap")},children:e&&e.clients.map(t=>(0,a.jsx)(T.i,{title:t.name,children:Object.keys(t.items).map(s=>t.items[s]?(0,a.jsxs)(d.T,{className:(0,g.cn)("flex flex-col gap-2 h-24 w-24","justify-center items-center"),variant:"flat",as:m.h,href:(0,Y.jJ)(s,k,e.title),target:"_self",children:[(0,a.jsx)(L.W,{src:Y.Is[s],alt:s,width:36}),s]},t.name+s):null)},t.name))})}),(0,a.jsx)(o.q,{})]})})})]}):null}},69547:()=>{}},e=>{e.O(0,[666,825,84,876,895,979,671,829,215,318,216,572,710,367,788,322,33,441,964,358],()=>e(e.s=20454)),_N_E=e.O()}]);